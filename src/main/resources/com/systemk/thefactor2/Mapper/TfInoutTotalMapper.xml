<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.systemk.thefactor2.Mapper.TfInoutTotalMapper">
    <select id="todayWork" resultType="TfInoutTotalVO" parameterType="java.util.Map">
        SELECT
           *
        FROM
            TF_INOUT_TOTAL
        WHERE
            IN_OUT_DATE = DATE_FORMAT( NOW(), '%Y%m%d')
        <if test="storeCd != null">
        AND
            STORE_CD = #{storeCd}
        </if>
    </select>

    <select id="todayWorkAll" resultType="java.util.Map">
        select IN_OUT_DATE , sum(IN_TOTCNT) as inputCount, sum(OUT_TOTCNT) as outputCount, sum(SELL_TOTCNT) as sellCount, sum(STOCK_TOTCNT) as stockCount
        FROM
            TF_INOUT_TOTAL
        WHERE
            IN_OUT_DATE = DATE_FORMAT( NOW(), '%Y%m%d') group by IN_OUT_DATE
    </select>

    <select id="monthWork" resultType="Map" parameterType="Integer">
        select
            DATE_FORMAT(DATE_ADD(NOW(), INTERVAL - ${item} MONTH), '%Y%m') as 'searchMonth',
            SUM(IN_TOTCNT) as 'inTotcnt',
            SUM(OUT_TOTCNT) as 'outTotcnt',
            SUM(SELL_TOTCNT) as 'sellTotcnt',
            SUM(STOCK_TOTCNT) as 'stockTotcnt',
            SUM(IN_NEWCNT) as 'inNewcnt',
            SUM(IN_MOVCNT) as 'inMovcnt',
            SUM(IN_INCNT) as 'inIncnt',
            SUM(IN_RETCNT) as 'inRetcnt',
            SUM(OUT_OUTCNT) as 'outOutcnt',
            SUM(OUT_MOVCNT) as 'outMovcnt',
            SUM(SELL_STCNT) as 'sellStcnt',
            SUM(SELL_ONLCNT) as 'sellOnlcnt'
        from
            tf_inout_total
        where
            IN_OUT_DATE like CONCAT(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL - ${item} MONTH), '%Y%m'), '%')
        <if test="storeCd != null">
            AND
            STORE_CD = #{storeCd}
        </if>
    </select>

</mapper>
